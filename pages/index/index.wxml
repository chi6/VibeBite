<!--index.wxml-->
<view class="container">
  <view class="notebook-container">


    <!-- ‰∏™ÊÄßÂåñÊé®ËçêÁ¨îËÆ∞Êú¨ -->
    <view class="notebook-section main-section">
      <view class="paper-title">
        <text class="title-text">‰∏™ÊÄßÂåñÊé®Ëçê</text>
        <text class="date-text">Âü∫‰∫é‰Ω†ÁöÑÈ•ÆÈ£üÂÅèÂ•Ω</text>
      </view>

      <!-- ‰æøÁ≠æÂºèÊ†áÁ≠æÈ°µ -->
      <view class="tabs-container">
        <view class="tab-list">
          <view class="tab {{currentTab === index ? 'active' : ''}}"
                wx:for="{{preferences.recommendations}}"
                wx:key="type"
                bindtap="switchTab"
                data-index="{{index}}">
            <text class="tab-icon">{{item.icon}}</text>
            <text class="tab-text">{{item.type}}</text>
          </view>
        </view>

        <!-- ‰æøÁ≠æÂÜÖÂÆπÂå∫Âüü -->
        <view class="notes-container">
          <view class="note-list {{currentTab === index ? 'show' : ''}}"
                wx:for="{{preferences.recommendations}}"
                wx:key="type">
            <view class="note-item {{openid ? 'editable' : ''}}"
                  wx:for="{{item.items}}"
                  wx:for-item="subItem"
                  wx:for-index="subIndex"
                  wx:key="description">
              
              <view class="note-content">
                <view class="note-text">{{subItem.description}}</view>
                
                <!-- ÁºñËæëÂíåÂà†Èô§ÊåâÈíÆ -->
                <view class="note-actions" wx:if="{{openid}}">
                  <view class="action-btn edit-btn"
                        catchtap="handleEdit"
                        data-category-index="{{index}}"
                        data-item-index="{{subIndex}}">
                    <text class="action-icon">‚úé</text>
                  </view>
                  <view class="action-btn delete-btn"
                        wx:if="{{item.items.length > 1}}"
                        catchtap="handleDelete"
                        data-category-index="{{index}}"
                        data-item-index="{{subIndex}}">
                    <text class="action-icon">üóëÔ∏è</text>
                  </view>
                </view>

                <!-- Ê†áÁ≠æ -->
                <view class="note-tags" wx:if="{{subItem.highlights.length > 0}}">
                  <text class="tag" wx:for="{{subItem.highlights}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
                </view>
              </view>
            </view>

            <!-- Ê∑ªÂä†ÊåâÈíÆ -->
            <view class="add-note" wx:if="{{openid}}" bindtap="handleAdd" data-category-index="{{index}}">
              <text class="add-icon">+</text>
              <text class="add-text">Ê∑ªÂä†Êñ∞È°πÁõÆ</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
